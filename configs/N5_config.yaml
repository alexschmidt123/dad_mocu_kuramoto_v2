# Configuration for 5-oscillator system
# This config file (N5_config.yaml) defines the experiment configuration
# The 'model_name' below is the identifier for where the trained model will be saved

# System parameters
N: 5
N_global: 6  # N + 1 for CUDA kernel

# Dataset generation
dataset:
  samples_per_type: 37500  # Total samples = 2 Ã— samples_per_type
  train_size: 70000
  K_max: 20480  # Monte Carlo samples for MOCU computation
  save_json: false

# Data generation optimization settings (production: use defaults for stability)
data_generation:
  num_workers: 2           # Conservative: 2 workers to avoid GPU memory issues with CUDA
  chunk_size: 10            # Samples per worker batch

# Training parameters
training:
  model_name: "cons5"  # Identifier for trained model directory (models/cons5/)
  epochs: 400
  constrain_weight: 0.0001
  batch_size: 128
  learning_rate: 0.001

# Experiment parameters
experiment:
  num_simulations: 10  # Number of random systems to test
  update_count: 4      # Sequential experiments per system (4 design steps = 5 total steps 0-4, since initial MOCU is fixed)
  it_idx: 10           # MOCU averaging iterations
  K_max: 20480
  methods:
    - "RANDOM"    # PyCUDA methods FIRST
    - "ENTROPY"
    - "ODE"
    - "iNN"       # PyTorch methods AFTER
    - "NN"
    - "DAD"
  
  # DAD training method (default: "reinforce" - RL with direct MOCU optimization)
  # Options: "reinforce" (RL, uses terminal MOCU directly as loss) or "imitation" (behavior cloning)
  dad_method: "reinforce"  # REINFORCE directly optimizes terminal MOCU

# DAD policy training data generation
dad_data:
  num_episodes: 10000      # Number of trajectories to generate (increased from 1000 to match iDAD data requirements)
                           # iDAD uses ~205M samples (on-the-fly), we use 10K pre-generated trajectories
                           # Can increase further if needed (50K-100K for better performance)
  K: 4                     # Number of sequential experiments per trajectory (4 design steps, aligns with experiment.update_count)
  use_precomputed_mocu: true  # Pre-compute terminal MOCU using MPNN predictor (recommended, avoids CUDA conflicts)

# Paths (relative to project root)
paths:
  data_dir: "data"
  models_dir: "models"
  results_dir: "results"

